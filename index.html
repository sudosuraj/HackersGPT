<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="color-scheme" content="dark" />
    <title>HackersGPT</title>
    <meta name="description" content="HackersGPT - Cybersecurity intelligence chat (client-side, serverless)." />

    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=IBM+Plex+Sans:wght@400;500;600&family=IBM+Plex+Mono:wght@400;500&display=swap"
      rel="stylesheet"
    />

    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github-dark.min.css"
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    />
    <link rel="stylesheet" href="./style.css" />
  </head>

  <body>
    <div class="app" id="app">
      <aside class="sidebar" id="sidebar" aria-label="Conversations">
        <div class="sidebar__top">
          <div class="brand" aria-label="HackersGPT">
            <div class="brand__mark" aria-hidden="true">&gt;_</div>
            <div class="brand__text">
              <div class="brand__name">HackersGPT</div>
              <div class="brand__tagline">The Unchained Cybersecurity Intelligence</div>
            </div>
          </div>

          <button class="btn btn--primary" id="newChatBtn" type="button">New chat</button>
        </div>

        <div class="sidebar__section">
          <div class="sidebar__sectionTitle">History</div>
          <div class="sidebarSearch" role="search">
            <label class="srOnly" for="historySearch">Search chats</label>
            <input
              class="sidebarSearch__input"
              id="historySearch"
              type="search"
              placeholder="Search chats"
              autocomplete="off"
              spellcheck="false"
              aria-label="Search conversations"
            />
            <button class="sidebarSearch__clear" id="clearHistorySearchBtn" type="button" aria-label="Clear search" hidden>
              &times;
            </button>
          </div>
          <ul class="convoList" id="convoList" aria-label="Conversation list"></ul>
        </div>

        <div class="sidebar__footer">
          <div class="meta">
            <div class="meta__row">
              <span class="meta__label">Model</span>
              <span class="meta__value" id="modelPill">default</span>
            </div>
            <div class="meta__row">
              <span class="meta__label">Storage</span>
              <span class="meta__value">Local only</span>
            </div>
          </div>

          <div class="sidebar__links">
            <a href="#" id="openSettingsLink">Settings</a>
            <a href="https://github.com/" target="_blank" rel="noreferrer">GitHub</a>
          </div>
        </div>
      </aside>

      <div class="main">
        <header class="topbar">
          <button
            class="iconBtn"
            id="sidebarToggle"
            type="button"
            aria-label="Toggle sidebar"
            aria-controls="sidebar"
            aria-expanded="false"
          >
            <span class="iconBtn__bars" aria-hidden="true"></span>
          </button>

          <div class="topbar__title">
            <span class="topbar__name">HackersGPT</span>
            <span class="topbar__sep" aria-hidden="true">&middot;</span>
            <span class="topbar__model" id="topModel">default</span>
          </div>

          <div class="topbar__actions">
            <button
              class="iconBtn"
              id="openSettingsBtn"
              type="button"
              aria-label="Open settings"
              aria-controls="settingsModal"
              aria-expanded="false"
            >
              <svg width="18" height="18" viewBox="0 0 24 24" aria-hidden="true">
                <path
                  fill="currentColor"
                  d="M12 15.6a3.6 3.6 0 1 1 0-7.2a3.6 3.6 0 0 1 0 7.2m9.2-3.1l-1.8-1l.2-2.1l-2.1-1.2l-1.6 1.3l-2-.9l-.4-2H10l-.4 2l-2 .9L6 8.2L3.9 9.4l.2 2.1l-1.8 1l1.8 1l-.2 2.1L6 15.8l1.6-1.3l2 .9l.4 2h3.6l.4-2l2-.9l1.6 1.3l2.1-1.2l-.2-2.1z"
                />
              </svg>
            </button>
          </div>
        </header>

        <main class="chat" id="chat" aria-label="Chat">
          <div class="messages" id="messages" aria-live="polite" aria-busy="false"></div>
        </main>

        <button class="toBottom" id="toBottomBtn" type="button" aria-label="Scroll to bottom" hidden>
          &#8595;
        </button>

        <footer class="composerWrap">
          <div class="status" id="status" role="status" aria-live="polite"></div>
          <form class="composer" id="composer" autocomplete="off">
            <label class="srOnly" for="prompt">Message</label>
            <textarea
              id="prompt"
              class="composer__input"
              rows="1"
              placeholder="Ask a cybersecurity question..."
              aria-label="Message input"
            ></textarea>
            <button class="btn btn--primary composer__send" id="sendBtn" type="submit">Send</button>
          </form>
          <div class="privacyNote">
            Runs in your browser. API calls go through <code>/api</code> (Vercel rewrite proxy) to reach api.llm7.io (for CORS).
          </div>
        </footer>
      </div>
    </div>

    <div class="backdrop" id="backdrop" hidden></div>

    <div class="modal" id="settingsModal" role="dialog" aria-modal="true" aria-labelledby="settingsTitle" hidden>
      <div class="modal__panel">
        <div class="modal__header">
          <div class="modal__title" id="settingsTitle">Settings</div>
          <button class="iconBtn" id="closeSettingsBtn" type="button" aria-label="Close settings">
            <svg width="18" height="18" viewBox="0 0 24 24" aria-hidden="true">
              <path
                fill="currentColor"
                d="M18.3 5.7a1 1 0 0 0-1.4 0L12 10.6L7.1 5.7a1 1 0 0 0-1.4 1.4l4.9 4.9l-4.9 4.9a1 1 0 1 0 1.4 1.4l4.9-4.9l4.9 4.9a1 1 0 0 0 1.4-1.4L13.4 12l4.9-4.9a1 1 0 0 0 0-1.4"
              />
            </svg>
          </button>
        </div>

        <div class="modal__body">
          <div class="field">
            <label class="field__label" for="baseUrl">Base URL</label>
            <input class="field__input" id="baseUrl" type="text" spellcheck="false" />
            <div class="field__hint">Default: /api (same-origin proxy; avoids CORS)</div>
          </div>

          <div class="field">
            <div class="field__row">
              <div class="field__label">Connection</div>
              <button class="btn btn--ghost btn--sm" id="testProxyBtn" type="button">Test</button>
            </div>
            <div class="field__hint" id="proxyStatus">Not tested.</div>
          </div>

          <div class="field">
            <div class="field__row">
              <label class="field__label" for="model">Model</label>
              <button class="btn btn--ghost btn--sm" id="refreshModelsBtn" type="button">Refresh</button>
            </div>
            <select class="field__input" id="model"></select>
            <div class="field__hint">Prefer selectors: default / fast / pro (pro may require paid token).</div>
          </div>

          <div class="field">
            <label class="field__label" for="token">Token (optional)</label>
            <input
              class="field__input"
              id="token"
              type="password"
              spellcheck="false"
              placeholder="Paste LLM7 token for higher limits"
            />
            <div class="field__hint">Stored locally. If empty, the app uses <code>Bearer unused</code>.</div>
          </div>

          <div class="field field--2col">
            <div>
              <label class="field__label" for="temperature">Temperature</label>
              <input class="field__input" id="temperature" type="number" min="0" max="2" step="0.1" />
            </div>
            <div>
              <label class="field__label" for="maxTokens">Max tokens</label>
              <input class="field__input" id="maxTokens" type="number" min="1" step="1" placeholder="(optional)" />
            </div>
          </div>

          <div class="field">
            <label class="field__label" for="streaming">
              <input id="streaming" type="checkbox" />
              Stream responses
            </label>
            <div class="field__hint">If streaming fails, the app automatically falls back to non-streaming.</div>
          </div>

          <div class="field">
            <div class="field__row">
              <button class="btn btn--ghost" id="exportBtn" type="button">Export chat (.md)</button>
              <button class="btn btn--danger" id="clearAllBtn" type="button">Clear all data</button>
            </div>
            <div class="field__hint">Clears conversations and settings from localStorage.</div>
          </div>
        </div>

        <div class="modal__footer">
          <button class="btn btn--ghost" id="cancelSettingsBtn" type="button">Cancel</button>
          <button class="btn btn--primary" id="saveSettingsBtn" type="button">Save</button>
        </div>
      </div>
    </div>

    <script
      src="https://cdnjs.cloudflare.com/ajax/libs/marked/12.0.2/marked.min.js"
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    ></script>
    <script
      src="https://cdnjs.cloudflare.com/ajax/libs/dompurify/3.0.8/purify.min.js"
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    ></script>
    <script
      src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    ></script>
    <script src="./js/search.js"></script>
    <script src="./app.js"></script>
  </body>
</html>
